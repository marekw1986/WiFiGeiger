<html>
<head>
<meta charset="UTF-8">
<title>Status systemu</title>
<link rel="stylesheet" type="text/css" href="/ui/style.css">
<link rel="stylesheet" type="text/css" href="/ui/menu.css">
<link rel="stylesheet" type="text/css" href="/ui/form.css">
<script language="javascript" type="text/javascript">
function reset(hard) {
	var result = document.getElementById('result');
	var token = document.getElementById('token');
	if (hard) {
		var r = confirm("Przywrócić domyślną konfigurację?")
		if (!r) return false;
	}
	var http_request;
	try {
	   http_request = new XMLHttpRequest();
	}
	catch (e) {
	   try {
		  http_request = new ActiveXObject("Msxml2.XMLHTTP");	
	   }
	   catch (e) {
			try {
				http_request = new ActiveXObject("Microsoft.XMLHTTP");
			}
			catch (e){
				result.innerHTML = "Wystąpił błąd przeglądarki. Wysłanie polecenia nie jest możliwe.";
				return false;
			}	
		}
	}
	http_request.onreadystatechange = function () {
		if (http_request.readyState === 4 && http_request.status === 200 ) {
            if (http_request.responseText === "invalid_token") {
                result.style.display = 'block';
                result.innerHTML = "Nieprawidłowy token operacji. Spróbuj ponownie załadować stronę.";
            }
			else if (http_request.responseText === "ok") {
				result.style.display = 'block';
				result.style.color = 'green';
				if (hard) {result.innerHTML = 'Przywrócono ustawienie fabryczne<br>Urządzenie zostało zresetowane';}
				else {result.innerHTML = "Urządzenie zostało zresetowane.";}
				
			}
			else {
				result.style.display = 'block';
				result.innerHTML = "Wystąpił błąd podczas resetowania urządzenia";					
			}
		}
	}
	var url = "/ui/reset.cgi?token=" + token.value;
	if (hard) {url += "&hardreset=yes";}
	http_request.open("GET", url, true);
	http_request.send();
	return true;
}
</script>
</head>
<body>
<script src="/ui/menu.js"></script>
<div id="main">
<h1>Status systemu</h1>

<input type="hidden" name="token" id="token" value="%configToken%">
<label>Uptime:</label><input type="text" value="%uptime%" disabled><br>
<label>Czas systemowy:</label><input type="text" value="%time%" disabled><br>
<label>Wersja SDK:</label><input type="text" value="%sdk%" disabled><br>
<label>Chip ID:</label><input type="text" value="%chipid%" disabled><br>
<label>Częstotliwość CPU:</label><input type="text" value="%cpufreq%" disabled><br>
<label>Restart urządzenia:</label><input type="button" value="Wykonaj" onclick="reset(0);"><br>
<label>Ustawienia fabryczne:</label><input type="button" value="Przywróć" onclick="reset(1);"><br>
<div id="result" style="color:red; display:none;"></div>
</div>
</body>
</html>
